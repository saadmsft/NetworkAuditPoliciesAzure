{
 "properties": {
  "displayName": "Public Network Access Audit",
  "policyType": "Custom",
  "description": "Set of Policies as initiative to do network access audit for Azure Services and VMs.",
  "metadata": {
   "category": "Public Endpoints",
   "version": "1.0",
   "createdBy": "c5cb6758-7582-4b1f-a783-2646cfd81fa9",
   "createdOn": "2021-12-14T19:36:09.0201092Z",
   "updatedBy": null,
   "updatedOn": null
  },
  "parameters": {},
  "policyDefinitions": [
   {
    "policyDefinitionReferenceId": "Adaptive network hardening recommendations should be applied on internet facing virtual machines_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/08e6af2d-db70-460a-bfe9-d5bd474ba9d6",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "[Preview]: Network traffic data collection agent should be installed on Linux virtual machines_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/04c4380f-3fae-46e8-96c9-30193528f602",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Management ports should be closed on your virtual machines_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/22730e10-96f6-4aac-ad84-9383d35b5917",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "[Preview]: Network traffic data collection agent should be installed on Windows virtual machines_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/2f2ee1de-44aa-4762-b6bd-0893fc3f306d",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "All network ports should be restricted on network security groups associated to your virtual machine_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/9daedab3-fb2d-461e-b861-71790eead4f6",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Management ports of virtual machines should be protected with just-in-time network access control_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b0f33259-77d7-4c9e-aac6-3aabcfae693c",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Non-internet-facing virtual machines should be protected with network security groups_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/bb91dfba-c30d-4263-9add-9c2384e659a6",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Internet-facing virtual machines should be protected with network security groups_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f6de0be7-9a8a-4b8a-b349-43cf02d22f7c",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Public network access should be disabled for Container registries_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0fdf0491-d080-4575-b627-ad0e843cba0f",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Public network access on Azure SQL Database should be disabled_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1b8ca024-1d5c-4dec-8995-b1a932b41780",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Public network access on Azure Data Factory should be disabled_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1cf164be-6819-4a50-b8fa-4bcaa4f98fb6",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Public network access should be disabled for Azure File Sync_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/21a8cd35-125e-4d13-b82d-2e19b7208bb7",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Public network access on Azure IoT Hub should be disabled_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/2d6830fb-07eb-48e7-8c4d-2a442b35f0fb",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Azure Cache for Redis should disable public network access_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/470baccb-7e51-4549-8b1a-3e5be069f663",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Azure Machine Learning workspaces should disable public network access_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/438c38d2-3772-465a-a9cc-7a6666a275ce",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Public network access should be disabled for PostgreSQL flexible servers_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/5e1de0e3-42cb-4ebc-a86d-61d0c619ca48",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Public network access should be disabled for Batch accounts_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/74c5a0ae-5e48-4738-b093-65e23a060488",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Public network access should be disabled for PostgreSQL servers_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b52376f7-9612-48a1-81cd-1ffe4b61032c",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Public network access should be disabled for MySQL flexible servers_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/c9299215-ae47-4f50-9c54-8a392f68a052",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Public network access should be disabled for MySQL servers_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/d9844e8a-1437-4aeb-a32c-0c992f056095",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Public network access should be disabled for MariaDB servers_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/fdccbe47-f3e3-4213-ad5d-ea459b2fa077",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Network interfaces should not have public IPs_1",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/83a86a26-fd1f-447c-b59d-e51f44264114",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Management ports should be closed on your virtual machines_2",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/22730e10-96f6-4aac-ad84-9383d35b5917",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "Management ports of virtual machines should be protected with just-in-time network access control_2",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b0f33259-77d7-4c9e-aac6-3aabcfae693c",
    "parameters": {},
    "groupNames": []
   },
   {
    "policyDefinitionReferenceId": "All network ports should be restricted on network security groups associated to your virtual machine_2",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/9daedab3-fb2d-461e-b861-71790eead4f6",
    "parameters": {},
    "groupNames": []
   }
  ],
  "policyDefinitionGroups": []
 },
 "id": "/subscriptions/cce00fcf-7529-4b3e-97f5-9447dca78c89/providers/Microsoft.Authorization/policySetDefinitions/8bedd180ad7e47798c512ac8",
 "type": "Microsoft.Authorization/policySetDefinitions",
 "name": "8bedd180ad7e47798c512ac8"
}